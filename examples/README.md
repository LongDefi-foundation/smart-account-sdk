# Example Guide

- This guide is for running example server.

## Prerequisite

- Installed `Foundry`. [installation](https://book.getfoundry.sh/getting-started/installation)
- Installed `bun`. [installation](https://bun.sh/docs/installation)

### 1. Clone contract repo and install dependencies

```sh
$ git clone git@github.com:LongDefi-foundation/core-contracts.git
$ cd core-contracts

$ forge install
$ bun install # yarn
```

### 2. Create `.env` in `core-contracts` repo

```ts
export API_KEY_INFURA="<API_KEY>"
export FOUNDRY_PROFILE="default"
```

### 3. Run anvil fork in `core-contracts` repo

```sh
$ source .env
$ anvil --fork-url https://sepolia.infura.io/v3/$API_KEY_INFURA --fork-block-number 5176224
```

### 4. Run server

```sh
$ bun run examples/index.ts
```

### 5. Call api to generate order

- Endpoint: `http://localhost:8080/order`
- Method: `POST`
- Request body:

  ```json
  {
  "initSmartAccount": boolean
  }
  ```

- Response:

  ```json
  {
    "smartAccount": "0x7c62696b195edbde3dae9ef21363ef289a71dac4",
    "userOperation": {
      "sender": "0x7c62696b195edbde3dae9ef21363ef289a71dac4",
      "nonce": "115113142668671579714129216421257609909633940207742104502001574057246508187648",
      "initCode": "0xe6a2c54b2e4695013f98415d71c2cf9cf0144c465fbfb9cf00000000000000000000000070997970c51812dc3a010c7d01b50e0d17dc79c80000000000000000000000000000000000000000000000000000018d563e6b5c",
      "callData": "0x47e1da2a000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000001000000000000000000000000c671db9c8c2e650fb5c9b9f119522700e5b7a95800000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000002710000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000104414bf389000000000000000000000000fff9976782d46cc05630d1f6ebab18b2324d6b1400000000000000000000000011cb8ef24755bc347aae8b9694f24d66fe94d6c20000000000000000000000000000000000000000000000000000000000000bb80000000000000000000000007c62696b195edbde3dae9ef21363ef289a71dac4800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000027100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
      "callGasLimit": "200000",
      "verificationGasLimit": "195336",
      "preVerificationGas": "0",
      "maxFeePerGas": "0",
      "maxPriorityFeePerGas": "0",
      "paymasterAndData": "0x",
      "signature": "0x90846918fe946eaee7a2866f76c995b73d91765ece7f034df33b475afef61ac75dac3a39910898fcd186eba71ffa015cbb16c30eccc41232331e8a34e5fc0ee21c"
    }
  }
  ```
